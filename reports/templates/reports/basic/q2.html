  <div class="question-2">
    <div class="row equal-heights">
      <div class="col-sm-12 col-md-6">
        <div class="report-card chart-card q1-pie-card report-card-red">
          <div class="report-card-head">
            <div class="title">EUROPE TOTAL</div>
            <div class="head-delim"></div>
          </div>
          <div class="report-card-body row">
            <div class="col-md-6 pie-info">
              <div class="report-card-text-lg q2-pie-answers" id="q2Percentage">
                <div class="q2-pie-answer">
                  <div id="q2PieYes" class="q2-pie-yes">
                    1894
                  </div>
                  <span class="answer">Yes</span>
                </div>
                <div class="q2-pie-answer">
                  <div id="q2PieNo" class="q2-pie-no">
                    1894
                  </div>
                  <span class="answer">No</span>
                </div>
              </div>
              <div class="pie-notice report-card-text">
                number of answers for each option across the whole survey
              </div>
            </div>
            <div class="pie q1-pie col-md-6">
              <canvas id="q2Pie" width="150" height="150" style="width: 150px; height: 150px;"></canvas>
              <div id="q2PieLegend" class="chart-legend pie-legend"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-12 col-md-6">
        <div class="report-card chart-card report-card-blue">
          <div class="report-card-head">
            <div class="title">BY COUNTRY</div>
            <div class="head-delim"></div>
          </div>
          <div class="report-card-body horizontal-bar-chart-body">
            <div class="horizontal-bar-chart" id="q2HorizontalBarChart">
              <div class="labeled-bars">
                <div class="y-labels"></div>
                <div class="horizontal-bars"></div>
              </div>
              <div class="x-labels">
                <div class="h-chart-x-label"><span>0</span></div>
                <div class="h-chart-x-label"><span>20%</span></div>
                <div class="h-chart-x-label"><span>40%</span></div>
                <div class="h-chart-x-label"><span>60%</span></div>
                <div class="h-chart-x-label"><span>80%</span></div>
                <div class="h-chart-x-label"><span>100%</span></div>
              </div>
              <div class="chart-legend h-bar-legend">
                <ul>
                  <li><span style="background-color:#328ec9"></span>Yes</li>
                  <li><span style="background-color:#b8103b"></span>No</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function() {
      $(document).ready(function() {
        var q2BarsData = [
          {
            label: 'GERMANY',
            positiveNum: 225,
            negativeNum: 40
          },
          {
            label: 'ITALY',
            positiveNum: 225,
            negativeNum: 80
          },
          {
            label: 'FRANCE',
            positiveNum: 225,
            negativeNum: 80
          },
          {
            label: 'SPAIN',
            positiveNum: 99999999999,
            negativeNum: 80
          },
          {
            label: 'NETHERLANDS',
            positiveNum: 225,
            negativeNum: 80
          },
          {
            label: 'LUXEMBURG',
            positiveNum: 80,
            negativeNum: 20
          }
        ];

        var $q2HorizontalBarChart = $('#q2HorizontalBarChart');

        drawYLabels($q2HorizontalBarChart, q2BarsData);
        drawBars($q2HorizontalBarChart, q2BarsData);
        adjustXLabels($q2HorizontalBarChart, q2BarsData);
        initTooltips($q2HorizontalBarChart);

        function drawBars($chart, data) {
          var $bars = $chart.find('.horizontal-bars');

          data.forEach(function(item) {
            var $bar = $('<div class="bar"></div>');

            var MIN_WIDTH = 1;
            var MAX_WIDTH = 99;

            var $positivePortionText = $('<span>' + item.positiveNum + '</span>');
            var $negativePortionText = $('<span>' + item.negativeNum + '</span>');

            var $positivePortion = $(
              '<div class="portion blue" ' +
              'data-toggle="tooltip" ' +
              'data-placement="top"' +
              ' title="' + item.positiveNum + '">' +
              '</div>'
            ).html($positivePortionText);

            var $negativePortion = $(
              '<div class="portion red" ' +
              'data-toggle="tooltip" ' +
              'data-placement="top"' +
              ' title="' + item.negativeNum + '">' +
              '</div>'
            ).html($negativePortionText);

            var positiveWidth = item.positiveNum / (item.positiveNum + item.negativeNum) * 100;
            if (positiveWidth > MAX_WIDTH) {
              positiveWidth = MAX_WIDTH;
            } else if (positiveWidth < MIN_WIDTH) {
              positiveWidth = MIN_WIDTH;
            }
            var negativeWidth = 100 - positiveWidth;

            $negativePortion.css('width', negativeWidth + '%');
            $positivePortion.css('width', positiveWidth + '%');

            $bar.append($positivePortion);
            $bar.append($negativePortion);
            $bars.append($bar);

            _hideTextIfOverflows($negativePortion, $negativePortionText);
            _hideTextIfOverflows($positivePortion, $positivePortionText);
          });
        }

        function drawYLabels($chart, data) {
          var $yLabels = $chart.find('.y-labels');

          data.forEach(function(item) {
            var $label = $('<div class="h-chart-y-label">' + item.label + '</div>');
            $yLabels.append($label);
          });
        }

        function adjustXLabels($chart, data) {
          var $xLabels = $chart.find('.x-labels');
          var xLabelsPaddingLeft = $chart.find('.y-labels').outerWidth();

          $xLabels.css('padding-left', xLabelsPaddingLeft);
        }

        function initTooltips($chart) {
          $chart.find('[data-toggle="tooltip"]').tooltip()
        }

        function _hideTextIfOverflows($container, $text) {
          if (!_isEnoughSpaceForText($container, $text)) {
            $container.empty();
          }
        }

        function _isEnoughSpaceForText($container, $text) {
          return $container.outerWidth() > $text.outerWidth();
        }
      });
    })();
  </script>
