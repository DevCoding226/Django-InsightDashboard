  <div class="question-1">
    <div class="row equal-heights">
      <div class="col-sm-6">
        <div class="report-card chart-card q1-pie-card report-card-red">
          <div class="report-card-head">
            <div class="title">EUROPE TOTAL</div>
            <div class="head-delim"></div>
          </div>
          <div class="report-card-body row">
            <div class="col-md-6 pie-info">
              <div class="pie-percentage report-card-text-lg" id="q1Percentage"></div>
              <div class="pie-notice report-card-text">
                total percentage of patients with SCZ that have abused drugs
              </div>
            </div>
            <div class="pie q1-pie col-md-6">
              <canvas id="q1Pie" width="150" height="150" style="width: 150px; height: 150px;"></canvas>
              <div id="q1PieLegend" class="chart-legend pie-legend"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="report-card chart-card report-card-blue">
          <div class="report-card-head">
            <div class="title">BY COUNTRY</div>
            <div class="head-delim"></div>
          </div>
          <div class="report-card-body bars-body">
            <div id="q1BarChart" class="ct-chart"></div>
            <div id="q1BarLabels" class="ct-bar-labels"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  (function() {
    $(document).ready(function() {
      var labels = ['GERMANY', 'ITALY', 'FRANCE', 'SPAIN', 'NETHERLANDS', 'LUXEMBURG'];
      var series = [50, 78, 36, 84, 25, 63];
      var barChart = new Chartist.Bar('#q1BarChart', {
        labels: labels,
        series: [series]
      }, {
        stackBars: false,
        high: 100,
        low: 0,
        axisY: {
          type: Chartist.FixedScaleAxis,
          ticks: [0, 50, 100],
          labelInterpolationFnc: setYAxisLabels
        }
      })
        .on('draw',setBarPercentage)
        .on('draw', setBarWidth)
        .on('created', drawBarLabels);

      $(document).on('resize', drawBarLabels);

      function setBarWidth(data) {
        if (data.type === "bar") {
          data.element.attr({
            style: 'stroke-width: 22px'
          });
        }
      }

      function setBarPercentage(data) {
        if (data.type === "bar") {
          var barHorizontalCenter, barVerticalCenter, label, value;
          barHorizontalCenter = data.x1 + (data.element.width() * .5);
          barVerticalCenter = data.y1 + (data.element.height() * -1) - 10;
          value = data.element.attr('ct:value');
          if (value !== '0') {
            label = new Chartist.Svg('text');
            label.text(value + '%');
            label.addClass("ct-barlabel");
            label.attr({
              x: barHorizontalCenter,
              y: barVerticalCenter,
              'text-anchor': 'middle'
            });
            return data.group.append(label);
          }
        }
      }

      function setYAxisLabels(value) {
        return (value) + '%';
      }

      function drawBarLabels() {
        var $barChartContainer = $('#q1BarChart');
        var barChartContainerPosition = $barChartContainer.offset();
        var $labels = $('#q1BarLabels');
        var $bars = $barChartContainer.find('.ct-bar');

        $labels.empty();

        $bars.each(function(i, bar) {
          var $bar = $(bar);
          var barPosition = $bar.offset();
          var $label = $('<div class="ct-bar-label">' + barChart.data.labels[i] + '</div>');
          $labels.append($label);
          var barHeight = bar.getBBox().height;
          var barWidth = bar.getBBox().width;
          var labelTop = barPosition.top - barChartContainerPosition.top + barHeight + 10;
          var labelLeft = barPosition.left - barChartContainerPosition.left + barWidth/2 - $label.width()/2;
          $label.css('top', labelTop);
          $label.css('left', labelLeft);
          $label.css('height', $label.width());
        });
      }
    });
  })();
</script>
