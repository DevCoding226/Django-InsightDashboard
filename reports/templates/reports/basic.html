{% extends "base.html" %}



{% block content %}
<div class="report">
  <div id="chartjs-tooltip">
    <table></table>
  </div>
  <h1 class="survey-overview-title">SURVEY OVERVIEW</h1>
  <div class="survey-cards">
    <div class="row equal-heights">
      <div class="col-md-3 col-sm-6">
        <div class="report-card report-card-red">
          <div class="report-card-head">
            <div class="title">SURVEYS</div>
            <div class="head-delim"></div>
            <div class="surveys-total report-card-text-lg">
              155
            </div>
          </div>
          <div class="report-card-body">
            <div class="report-card-text-lg">
              <div class="report-card-text-lesser left-1">17:20 CET</div>
              15 JAN 2017
            </div>
            <div class="report-card-text">
              Number of surveys received
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="report-card report-card-gray">
          <div class="report-card-head">
            <div class="title">DRUG ABUSE SPECIALISED MENTAL HEALTH CENTERS</div>
            <div class="head-delim"></div>
          </div>
          <div class="report-card-body">
            <div class="report-card-text-lg">
              77
            </div>
            <div class="report-card-text">
              Text regarding the data
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="report-card report-card-gray">
          <div class="report-card-head">
            <div class="title">MENTAL HEALTH CENTRES</div>
            <div class="head-delim"></div>
          </div>
          <div class="report-card-body">
            <div class="report-card-text-lg">
              77
            </div>
            <div class="report-card-text">
              Text regarding the data
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="report-card report-card-gray">
          <div class="report-card-head">
            <div class="title">HOSPITALS</div>
            <div class="head-delim"></div>
          </div>
          <div class="report-card-body">
            <div class="report-card-text-lg">
              77
            </div>
            <div class="report-card-text">
              Text regarding the data
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

{% include 'reports/basic/q1.html' %}
{% include 'reports/basic/q2.html' %}
{% include 'reports/basic/q3.html' %}

</div>

<script>
    (function () {

  function drawQ1Pie() {
    var q1PieData = {
      labels: [
        "No abuse",
        "Substance abuse"
      ],
      datasets: [
        {
          data: [128, 72],
          backgroundColor: [
            "#328ec9",
            "#b8103b"
          ],
          hoverBackgroundColor: [
            "#328ec9",
            "#b8103b"
          ]
        }]
    };

    var total = q1PieData.datasets[0].data.reduce(function(a,b) {return a + b});
    var percentage = Math.round(q1PieData.datasets[0].data[1]/total*100);

    $('#q1Percentage').html(percentage + '%');
    drawPie(q1PieData, '#q1Pie', '#q1PieLegend')
  }

  function drawQ2Pie() {
    var q2PieData = {
      labels: [
        "No difference",
        "Treats differently"
      ],
      datasets: [
        {
          data: [128, 72],
          backgroundColor: [
            "#b8103b",
            "#328ec9"
          ],
          hoverBackgroundColor: [
            "#b8103b",
            "#328ec9"
          ]
        }]
    };

    var yesNum = q2PieData.datasets[0].data[0];
    var noNum = q2PieData.datasets[0].data[1];

    $('#q2PieYes').css('color', q2PieData.datasets[0].backgroundColor[0]).html(yesNum);
    $('#q2PieNo').css('color', q2PieData.datasets[0].backgroundColor[1]).html(noNum);

    drawPie(q2PieData, '#q2Pie', '#q2PieLegend')
  }

  function drawPie(pieData, pieId, legendId) {
    var pieCtx = $(pieId).get(0).getContext("2d");
    var pieLegend = $(legendId);
    var pie = new Chart(pieCtx,{
      type: 'pie',
      data: pieData,
      options: {
        legend: false,
        tooltips: {
          enabled: false
        }
      }
    });
    pieLegend.html(pie.generateLegend());
  }

  $(document).ready(function() {
    drawQ1Pie();
    drawQ2Pie();
  })
})();

</script>
{% endblock content %}
